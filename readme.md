# Json Parser

The package contains various json parser implementations mainly for the education purpose.

I wanted to study how to implement a custom parser (mainly using recursive descendant approach) checking if there are any benefits from using TypedArrays (like Uint8Array) to represent the input.

## Results

The benchmarks are generated by [mitata](https://github.com/evanwashere/mitata) package.

```sh
clk: ~3.11 GHz
cpu: Apple M2
runtime: node 22.9.0 (arm64-darwin)

benchmark                           avg (min … max) p75 / p99    (min … top 1%)
--------------------------------------------------- -------------------------------
douglas crockford rdp 900kb            9.27 ms/iter   9.34 ms           ▂▄█▄▅▇▇
                                (9.03 ms … 9.45 ms)   9.44 ms ▃▃▃▆▇▆▇▇▆████████▆█▃▄
                          gc(  2.05 ms …   3.80 ms)   8.54 mb (  8.54 mb…  8.57 mb)

douglas crockford rdp 2 [eval] 900kb   7.94 ms/iter   7.88 ms ▇█
                               (7.61 ms … 13.71 ms)  13.67 ms ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
                          gc(  1.51 ms …   3.72 ms)   8.37 mb (  8.33 mb…  9.38 mb)

typed rdp 900kb                        8.90 ms/iter   8.86 ms  ▅█
                               (8.52 ms … 11.79 ms)  11.78 ms ▄██▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂
                          gc(  3.14 ms …   4.84 ms)  11.56 mb ( 11.55 mb… 11.70 mb)

typed rdp 2 900kb                      8.35 ms/iter   8.42 ms    ▂     █▂█▂▄▄▆▆
                                (8.15 ms … 8.51 ms)   8.51 ms ▃█▅█▅▅█▅▅████████▇▇▅▅
                          gc(  3.06 ms …   5.36 ms)   9.34 mb (  9.34 mb…  9.73 mb)

typed rdp 3 900kb                      6.87 ms/iter   6.92 ms          █ ▂ ▂
                                (6.69 ms … 7.15 ms)   7.10 ms ▄▄▃▅▆▄▇▇████▆█▆▁▂▃▂▁▂
                          gc(  2.97 ms …   5.07 ms)   6.73 mb (  6.73 mb…  6.84 mb)

typed rdp class 900kb                 12.24 ms/iter  12.41 ms        ▆▆ █ ▂
                              (11.79 ms … 12.73 ms)  12.71 ms ▃▅█▃▇▅█████▃█▅▅█▇█▃▁▅
                          gc(  3.14 ms …   5.22 ms)  11.66 mb ( 11.63 mb… 11.68 mb)

typed rdp class 2 900kb               11.12 ms/iter  11.33 ms  ▇▇ ██
                              (10.58 ms … 12.62 ms)  12.57 ms ▆██▅██▂▄▆▅▂▄▅▂▂▂▁▁▁▁▄
                          gc(  3.19 ms …   4.73 ms)   9.47 mb (  9.09 mb…  9.89 mb)
```

## Learnings

At first glance, TypedArray usage seems to be slightly better, however, it mainly depends on the implementation. Moreover, TypedArray based implementation can get additional advantage by removing string to TypedArray conversion from the parsing call.

Number parsing may be improved by avoid string to number conversion. Instead, we can try to reconstruct original number by using math operations.

"eval" approach seems to be slightly better, however, it hightly depends on the input data and on the parsing implementation. So it is not the best.


## Appendix

- [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)
